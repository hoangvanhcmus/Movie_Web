<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
            <title>
                Bootstrap and jquery
            </title>
            <meta content="width=device-width, initial-scale=1" name="viewport">
                <link href="css/style.css" rel="stylesheet">
                    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
                        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js">
                        </script>
                        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js">
                        </script>
                        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js">
                        </script>
                        <style>
                            body {
        font-family: 'Oxygen', sans-serif;
    }
    
    .appPageTitle {
        margin: 20px 0 30px;
        text-align: center;
    }
    
    .btnContainer {
        margin: 20px 0;
        text-align: center;
    }
    
    #searchBtnContainer {
        display: inline-block;
        margin: 10px;
    }
    
    #refreshBtnContainer {
        margin: 10px;
    }
    
    .searchFilmTitles {
        height: 50px;
        padding: 10px;
    }
    
    .movieCard {
        padding-top: 20px;
    }
    
    .movieTitle {
        color: blue;
        text-align: center;
        padding: 20px 0;
        margin: 10px;
        border: 1px solid grey;
        width: 300px;
        height: 380px;
        float: left;
    }
    
    .vote{
        color: white;
        text-align: center;
        margin: 10px;
        border: 1px;
        width: 217px;
        height: 368px;
        float: left;
    }

    .timeFilm{
        text-align: center;
        margin: 10px;
        border: 1px solid grey;
        width: 217px;
        height: 368px;
        float: left;
    }

    #showTitle {
        padding: 12px;
    }
    
    .littleSpace {
        padding: 20px 0;
    }
    
    .movieTitle_detailView {
        text-align: center;
        padding: 20px 0;
        margin: 10px 0;
        border: 1px solid grey;
        width: 90%;
    }
    
    .movieDetail_actors {
        display: none;
    }
    
    .actorsFeatured {
        text-align: center;
        padding: 0 0 10px 0;
        margin: 10px;
        border: 1px solid grey;
        float: left;
    }
    
    .actorDetail {
        display: none;
    }
    
    .actorShowTopMovies {
        display: none;
    }
    
    .actorPopMovies {
        display: inline;
    }
    
    .actorPageTitle {
        text-align: center;
        padding: 20px 0;
        margin: 10px 0;
        border: 1px solid grey;
    }
    
    .actorPopMoviesList {
        text-align: center;
        padding: 20px 0;
        margin: 10px;
        border: 1px solid grey;
        width: 217px;
        float: left;
    }
    
    .actorFilmTitles {
        height: 50px;
        padding: 10px;
    }
    div.inline { float:right; }
    .clearBoth { clear:right; }
                        </style>
                    </link>
                </link>
            </meta>
        </meta>
    </head>
    <body class="bg-dark" onload="LoadPage()">
        <header class="container">
            <div class="carousel slide" data-ride="carousel" id="demo">
                <!-- Indicators -->
                <ul class="carousel-indicators">
                    <li class="active" data-slide-to="0" data-target="#demo">
                    </li>
                    <li data-slide-to="1" data-target="#demo">
                    </li>
                    <li data-slide-to="2" data-target="#demo">
                    </li>
                </ul>
                <!-- The slideshow -->
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <img alt="film" height="500" src="img/slide1.png" width="1100">
                            <div class="carousel-caption">
                                <h3>
                                    Baby Driver
                                </h3>
                                <p>
                                    Action film written and directed by Edgar Wright
                                </p>
                            </div>
                        </img>
                    </div>
                    <div class="carousel-item">
                        <img alt="film" height="500" src="img/slide2.png" width="1100">
                            <div class="carousel-caption">
                                <h3>
                                    Batman v Superman: Dawn of Justice
                                </h3>
                                <p>
                                    American superhero film featuring the DC Comics characters Batman and Superman
                                </p>
                            </div>
                        </img>
                    </div>
                    <div class="carousel-item">
                        <img alt="film" height="500" src="img/slide3.png" width="1100">
                            <div class="carousel-caption">
                                <h3>
                                    Harry Potter and The Prisoner of Azkaban
                                </h3>
                                <p>
                                    Fantasy film directed by Alfonso Cuar√≥n
                                </p>
                            </div>
                        </img>
                    </div>
                </div>
                <!-- Left and right controls -->
                <a class="carousel-control-prev" data-slide="prev" href="#demo">
                    <span class="carousel-control-prev-icon">
                    </span>
                </a>
                <a class="carousel-control-next" data-slide="next" href="#demo">
                    <span class="carousel-control-next-icon">
                    </span>
                </a>
            </div>
        </header>
        <main>
            <div class="container-fluid">
                <div class="row-fluid btnContainer">
                    <div class="inline" id="searchBtnContainer" s="">
                        <input class="form-control mr-sm-2" id="movie" name="searchMovies" placeholder="Search for a movie" type="text"/>
                        <br>
                            <button class="btn btn-success" id="searchBtn">
                                Search
                            </button>
                            <input class="btn btn-success" id="refreshBtn" type="button" value="Refresh">
                            </input>
                        </br>
                    </div>
                </div>
            </div>
            <div id="noMatch">
            </div>
            <div class="container-fluid" id="showSearchResult">
                <div class="row movieCard">
                </div>
            </div>
            <div class="container-fluid movieShowActors">
                <div class="chosenTitle">
                </div>
                <div class="row-fluid">
                    <div class="movieDetail_actors">
                    </div>
                </div>
            </div>
            <div class="container-fluid actorShowTopMovies">
                <div class="actorPageTitle">
                </div>
                <div class="row-fluid">
                    <div class="actorPopMovies">
                    </div>
                </div>
            </div>
            <script>

                function LoadPage(){
                    var baseUrl = 'http://api.themoviedb.org/3/',
                                trendingDay='trending/movie/day',
                                key = '&api_key=1b28abc5f4b5a2e02a3472c81a774c76';
                                $.ajax({
                type:'GET',
                url: baseUrl+trendingDay+key,
                async:false,
                jsonpCallbacks:'test',
                contentType: 'application/json',
                dataType:'json',
                success:function(json){
                    for (i = 0; i < json.results.length; i++) {
                        titleItems = json.results[i].title;
                        movie_id = json.results[i].id;
                        posterItems = json.results[i].poster_path;
                        vote=json.results[i].vote_average;

                        $(".movieCard").append("<div class=" + "movieTitle" + " " + "id=" + movie_id + ">" + "<img " + "class=" + "posterImg" + " " + "src=" + "https://image.tmdb.org/t/p/w185_and_h278_bestv2" + posterItems + " />" + "<br>" + "<div class=" + "searchFilmTitles" + ">" +titleItems + "</div>" + "<div class="+"searchFilmRate"+">"+"Rate: "+vote+"</div>" + "</br>");
                    }
                }
                                });



                };

                
                $(document).ready(function() {
        //Search input focused at the page load
        $("#movie").focus();
        //Button to refresh page and start search over
        $('#refreshBtn').click(function() {
            location.reload();
        });
        // Variables to fetch urls from API
        var baseUrl = 'http://api.themoviedb.org/3/',
            discover = 'discover/',
            mode = 'search/movie',
            query = '?query=',
            ampQuery = '&query=',
            search = 'search/',
            sort_by_popularity = '&sort_by=popularity.desc',
            trendingDay='trending/all/day',
            movieQuery = 'movie?',
            movie = 'movie',

            //person = 'person',
            person_id,
            movie_credits = 'movie_credits?',
            director,
            releaseDate,
            movieType,
            summary,
            input,
            titleItems,
            movieName,
            movie_id,
            actorNames,
            actor_id,
            with_people = "&with_people=",
            credits = 'credits?',
            key = '&api_key=1b28abc5f4b5a2e02a3472c81a774c76',
            sort_by = '&sort_by=original_title.desc',
            page = '&page=1';





        /*window.onload=function() {
            $.ajax({
                type:'GET',
                url :baseUrl + trendingDay + key,
                async:false,
                jsonpCallbacks:'test',
                contentType: 'application/json',
                dataType:'json',
                success:function(json){
                    for (i = 0; i < json.results.length; i++) {
                        titleItems = json.results[i].title;
                        movie_id = json.results[i].id;
                        posterItems = json.results[i].poster_path;
                        vote=json.results[i].vote_average;

                        $(".movieCard").append("<div class=" + "movieTitle" + " " + "id=" + movie_id + ">" + "<img " + "class=" + "posterImg" + " " + "src=" + "https://image.tmdb.org/t/p/w185_and_h278_bestv2" + posterItems + " />" + "<br>" + "<div class=" + "searchFilmTitles" + ">" +titleItems + "</div>" + "<div class="+"searchFilmRate"+">"+"Rate: "+vote+"</div>" + "</br>");
                    }
                }
            })
        };*/

        /*$.ajax({
            type:'GET',
            url: baseUrl + trendingDay + key,
            async:false,
            jsonpCallbacks:'test',
            contentType: 'application/json',
            dataType:'jsonp',
            success:function(json){
                for (i = 0; i < json.results.length; i++) {
                    titleItems = json.results[i].title;
                    movie_id = json.results[i].id;
                    posterItems = json.results[i].poster_path;
                    vote=json.results[i].vote_average;

                    $(".movieCard").append("<div class=" + "movieTitle" + " " + "id=" + movie_id + ">" + "<img " + "class=" + "posterImg" + " " + "src=" + "https://image.tmdb.org/t/p/w185_and_h278_bestv2" + posterItems + " />" + "<br>" + "<div class=" + "searchFilmTitles" + ">" +titleItems + "</div>" + "<div class="+"searchFilmRate"+">"+"Rate: "+vote+"</div>" + "</br>"),
                }
            },

            error: function(e) {
                console.log(e.message);
            }
        });*/


        $('#searchBtnContainer').on('click', 'button', function() {
            var input = $('#movie').val(),
                movieName = encodeURI(input);
            $.ajax({
                type: 'GET',
                url: baseUrl + mode + query + input + key + sort_by_popularity,
                async: false,
                jsonpCallback: 'test',
                contentType: 'application/json',
                dataType: 'jsonp',
                success: function(json) {
                    for (i = 0; i < json.results.length; i++) {
                        titleItems = json.results[i].title;
                        movie_id = json.results[i].id;
                        posterItems = json.results[i].poster_path;
                        vote=json.results[i].vote_average;

                        $(".movieCard").append("<div class=" + "movieTitle" + " " + "id=" + movie_id + ">" + "<img " + "class=" + "posterImg" + " " + "src=" + "https://image.tmdb.org/t/p/w185_and_h278_bestv2" + posterItems + " />" + "<br>" + "<div class=" + "searchFilmTitles" + ">" +titleItems + "</div>" + "<div class="+"searchFilmRate"+">"+"Rate: "+vote+"</div>" + "</br>");
                        

                    }
                    
                },
                error: function(e) {
                    console.log(e.message);
                }
            });
            $.ajax({
                type: 'GET',
                url: baseUrl + "/search/person" + input + key,
                async: false,
                jsonpCallback: 'test',
                contentType: 'application/json',
                dataType: 'jsonp',
                success: function(json) {
                    for (j = 0; j < json.cast.length; j++) {
                        titleItems = json.known_for[i].title;
                        movie_id = json.known_for[i].id;
                        posterItems = json.known_for[i].poster_path;
                        vote=json.results[i].vote_average;

                        $(".movieCard").append("<div class=" + "movieTitle" + " " + "id=" + movie_id + ">" + "<img " + "class=" + "posterImg" + " " + "src=" + "https://image.tmdb.org/t/p/w185_and_h278_bestv2" + posterItems + " />" + "<br>" + "<div class=" + "searchFilmTitles" + ">" +titleItems + "</div>" + "<div class="+"searchFilmRate"+">"+"Rate: "+vote+"</div>" + "</br>");
                    }
                },
                error: function(e) {
                    console.log(e.message);

                }

            });
            // Shows warning message when there is no result
            setTimeout(function() {
                if ($(".movieCard").has(".movieTitle").length == 0) {
                    $("#noMatch").css('display', 'block');
                } else {
                    $("#noMatch").css('display', 'none');
                }
            }, 200);
            //End of button click function
        });
        //Search button triggered with enter key:
        $('#searchBtnContainer').on('keyup', 'input', function(e) {
            if (e.keyCode == 13) {
                $('#searchBtn').trigger('click');
                return false;
            }
        });
        //Clears out search result when input field is focused or input value is changed
        $("#movie").on("change keyup paste", function() {
            $('#showSearchResult div').empty();
        });
        // 2) Show movie detail with name of actors///
        ///movie/{movie_id}/credits

        $('.movieCard').on("click", '.movieTitle', function(event) {
            var selectedMovie_id = this.id;
            var selectedMovieTitle = this.innerText;
            $('.movieDetail_actors').css('display', 'inline');
            $("#showSearchResult").css('display', 'none');
            /*$.ajax({
                type: 'GET',
                url: baseUrl + movie + "/" + selectedMovie_id + key,
                async: false,
                jsonpCallback: 'test',
                contentType: 'application/json',
                dataType: 'jsonp',
                success: function (json){
                    //director=json.production_companies[0].name;
                   // summary=json.overview;
                    $(".chosenTitle").append("<div class=" + "movieTitle_detailView" + " " + "id=" + selectedMovie_id + ">" 
                        + "<span>" + selectedMovieTitle + "</span>" 
                        //+ "<span>" + director + "</span>"


                        + "</div>");
                },
                error: function(e) {
                    console.log(e.message);

                }
            });*/


            $.ajax({
                type: 'GET',
                url: baseUrl + movie + "/" + selectedMovie_id + "/" + credits + key,
                async: false,
                jsonpCallback: 'test',
                contentType: 'application/json',
                dataType: 'jsonp',
                success: function(json) {
                    $(".chosenTitle").append("<div class=" + "movieTitle_detailView" + " " + "id=" + selectedMovie_id + ">" 
                        + "<span>" + selectedMovieTitle + "</span>" 
                        //+ "<span>" + director + "</span>"


                        + "</div>");
                
                    for (j = 0; j < json.cast.length; j++) {
                        actorNames = json.cast[j].name;
                        actor_id = json.cast[j].id;
                        actorImgItem = json.cast[j].profile_path;
                        $(".movieDetail_actors").append("<div class=" + "actorsFeatured" + " " + "id=" + actor_id + ">" + "<img " + "class=" + "actorImg" + " " + "src=" + "https://image.tmdb.org/t/p/w185_and_h278_bestv2" + actorImgItem + " />" + "<br>" + actorNames + " " + "</div>");
                    }
                },
                error: function(e) {
                    console.log(e.message);

                }

            });


        });
        // 3) Show Top 10 movies by chosen actor///
        $('.movieDetail_actors').on("click", '.actorsFeatured', function(event) {
            $('.actorShowTopMovies').css('display', 'block');
            $(".movieShowActors").css('display', 'none');
            var selectedActor_id = this.id;
            var selected_actorName = this.innerText;
            $.ajax({
                type: 'GET',
                url: baseUrl + discover + movieQuery + key + with_people + selectedActor_id + sort_by_popularity,
                async: false,
                jsonpCallback: 'test',
                contentType: 'application/json',
                dataType: 'jsonp',
                success: function(json) {
                    $(".actorPageTitle").append("<div class=" + "actorShowName" + " " + "id=" + selectedActor_id + ">" + "<span>" + selected_actorName + "</span>" + "</div>");
                    for (p = 0; p < json.results.length; p++) {
                        // console.log(json.cast[p].title);
                        var actors_film_id = json.results[p].id;
                        var actorFilms = json.results[p].title;
                        var actorFilmPosterImg = json.results[p].poster_path;
                        $(".actorPopMovies").append("<div class=" + "actorPopMoviesList" + " " + "id=" + actors_film_id + ">" + "<img " + "class=" + "posterImg" + " " + "src=" + "https://image.tmdb.org/t/p/w185_and_h278_bestv2" + actorFilmPosterImg + " />" + "<br>" + "<div class= " + "actorFilmTitles" + ">" + actorFilms + "</div>" + "</div>");
                    }
                },
                error: function(e) {
                    console.log(e.message);
                }
            });
        });
        //End of Document.ready
    });


function pagination(){
    var req_num_row=10;
    var $tr=jQuery('tbody tr');
    var total_num_row=$tr.length;
    var num_pages=0;
    if(total_num_row % req_num_row ==0){
        num_pages=total_num_row / req_num_row;
    }
    if(total_num_row % req_num_row >=1){
        num_pages=total_num_row / req_num_row;
        num_pages++;
        num_pages=Math.floor(num_pages++);
    }
    for(var i=1; i<=num_pages; i++){
        jQuery('#pagination').append("<a href='#' class='btn'>"+i+"</a>");
    }
    $tr.each(function(i){
        jQuery(this).hide();
        if(i+1 <= req_num_row){
            $tr.eq(i).show();
        }

    });
    jQuery('#pagination a').click(function(e){
        e.preventDefault();
        $tr.hide();
        var page=jQuery(this).text();
        var temp=page-1;
        var start=temp*req_num_row;
        //alert(start);

        for(var i=0; i< req_num_row; i++){

            $tr.eq(start+i).show();

        }
    });
}
            </script>
        </main>
    </body>
</html>